#### å¼€å‘èƒŒæ™¯

> åšå®¢å¾ˆä¹…æ²¡æœ‰æ›´æ–°äº†ï¼Œ ä»Šå¤©æ›´æ–°ä¸€ä¸ªå¥½ç©çš„ï¼Œç­‰æˆ‘å°†vue3çš„ä¸œè¥¿å½»åº•ææ˜ç™½æˆ‘ä¼šæ›´æ–°ä¸€ä¸ªvue3çš„ç³»åˆ—ï¼Œåˆ°æ—¶å€™ä¼šæ›´æ–°ç¨å¾®å‹¤ä¸€ç‚¹ï¼Œåœ¨ä½¿ç”¨vuecliçš„æ—¶å€™å‘ç°ä»–çš„è„šæ‰‹æ¶å¾ˆæœ‰æ„æ€ï¼Œç”¨äº†å‡ å¹´äº†ï¼Œä½†æ˜¯ä¸€ç›´æ²¡æœ‰å¥½å¥½ç ”ç©¶è¿‡è¿™ä¸ªä¸œè¥¿æ˜¯æ€ä¹ˆå®ç°çš„ï¼Œæ‰€ä»¥ä»Šå¤©å°±å¥½å¥½çš„è®°å½•ä¸€ä¸‹è¿™ç©æ„æ€ä¹ˆå®ç°çš„ï¼Œè®°å½•çš„è¿‡ç¨‹ä¸­æœ‰ä»€ä¹ˆæ³¨æ„äº‹é¡¹æˆ‘ä¹Ÿä¼šæ ‡æ˜çš„ï¼Œå½“ç„¶æˆ‘ä¼šå°½å¯èƒ½çš„å†™çš„æ˜ç™½ä¸€äº›ï¼Œå› ä¸ºè¿™ä¸ªä¸œè¥¿æœ‰ä¸€äº›åœ°æ–¹ä¸é‚£ä¹ˆå¥½ç†è§£ï¼Œå½“ä¸€ä¸ªä¸œè¥¿ä¸å¤ªå¥½ç†è§£çš„æ—¶å€™æ–‡ç« ä¹¦å†™çš„é¡ºåºå°±æ˜¾çš„å¾ˆé‡è¦ï¼Œå› ä¸ºå¼€å§‹çš„æ—¶å€™å¦‚æœä½ å°±å¾ˆè¿·èŒ«ï¼Œé‚£ä¹ˆä½ çœ‹ä¸‹å»çš„çœ‹åŠ¨åŠ›ä¹Ÿå°±æ²¡æœ‰äº†ï¼Œæ‰€ä»¥æˆ‘ä¹Ÿæ˜¯å°½å¯èƒ½çš„ä»æœ€ç®€å•çš„å¼€å§‹å†™ï¼Œç›¸ä¿¡åªè¦æŒ‰ç…§æ–‡ç« ä¸€ç‚¹ç‚¹çš„æ¥ï¼Œåº”è¯¥éƒ½æ˜¯æ²¡é—®é¢˜çš„ï¼Œæˆ‘æ–‡ç« çš„é¡ºåºå°±æ˜¯æˆ‘è‡ªå·±å¼€å‘è¿™ä¸ªåŠŸèƒ½çš„é¡ºåºï¼Œå¦‚æœæœ‰å¤§ç¥è§‰å¾—æˆ‘å“ªé‡Œå†™çš„æœ‰ä»€ä¹ˆé—®é¢˜çš„è¯ï¼Œä¹Ÿå¯ä»¥ä¸‹æ–¹ç•™è¨€ï¼Œæˆ‘çœ‹åˆ°äº†éƒ½ä¼šè¡¥å……è¯´æ˜å¹¶è¡¨ç¤ºæ„Ÿè°¢ã€‚

#### åˆå§‹åŒ–ä¸€ä¸ªpackage.json

```base
npm init æˆ–è€… npm init -y
```

#### åˆå§‹åŒ–ä¸€ä¸ªæµ‹è¯•æ–‡ä»¶

```js
#!/usr/bin/env node
console.log("function is success")
```

> **ç‰¹æ®Šè¯´æ˜ï¼š** #!/usr/bin/env node è¿™é‡Œæ˜¯å¿…é¡»è¦åŠ çš„ï¼Œå¦‚æœä½ å®åœ¨ä¸ç†è§£ï¼Œé‚£ä¹ˆä½ å¯ä»¥å…ˆè¿™æ ·å†™ï¼Œå¦å¤–å°±æ˜¯è¿™è¡Œä»£ç å¿…é¡»æ˜¯ç¬¬ä¸€è¡Œï¼Œä»–çš„å‰é¢ä¸å¯ä»¥æœ‰ä»»ä½•ä»£ç  å½“ç„¶è¿™é‡Œä¹Ÿå¯ä»¥è§£é‡Šä¸€ä¸‹ï¼Œä½ å¯ä»¥ç®€å•çš„ç†è§£ä¸ºå¢åŠ è¿™ä¸€è¡Œæ˜¯ä¸ºäº†æŒ‡å®šç”¨nodeæ‰§è¡Œè„šæœ¬æ–‡ä»¶ã€‚å¦‚æœæƒ³æ·±å…¥ç†è§£è¿™ä¸ªä¸œè¥¿ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹å¤§ç¥çš„ä»‹ç»[Shebang](https://blog.csdn.net/u012294618/article/details/78427864) å¸Œæœ›å¯ä»¥æœ‰ç‚¹å¸®åŠ©

#### è¿è¡Œè¯¥æ–‡ä»¶

```base
node index.js
```

#### å°†node index.js æ›¿æ¢ä¸ºè‡ªå®šä¹‰å‘½ä»¤ 

##### æ¯”å¦‚ï¼šwlm

æˆ‘ä»¬çš„ç›®çš„æ˜¯ï¼Œå½“æˆ‘ä»¬è¾“å…¥ wlmçš„æ—¶å€™ æ‰§è¡Œçš„æ˜¯node index.jsè¿™å¥è¯å³å¯

#### é…ç½®package.json

```json
{
  "name": "wlm-cli",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "author": "",
  "license": "ISC",
  "bin": {
    "wlm":"index.mjs"
  }
}
```

###### binå‘½ä»¤ è¯´æ˜

> "bin": {
>     "wlm":"index.js"
>   }
>
> è¿™é‡Œçš„binå°±æ˜¯æˆ‘ä»¬éœ€è¦ä½¿ç”¨çš„ç»ˆç«¯å‘½ä»¤ï¼Œåé¢çš„æ–‡ä»¶å°±æ˜¯æˆ‘ä»¬æŒ‡å®šçš„mjsæ–‡ä»¶ï¼Œå½“ç„¶è¿™ä¸ªæ–‡ä»¶ä½ å¯ä»¥è‡ªå·±å°è£…ï¼Œåªè¦æ˜¯ä¸€ä¸ªå…¥å£æ–‡ä»¶å°±å¯ä»¥ï¼Œvue-cliæºç è¿™é‡ŒæŒ‡å‘çš„å°±æ˜¯ä¸€ä¸ªbinæ–‡ä»¶

#### å‘å¸ƒè¯¥å‘½ä»¤

```base
npm link  // å°†binè„šæœ¬ä¸‹çš„å‘½ä»¤è¿›è¡Œå‘å¸ƒåˆ°æœ¬åœ°ï¼Œæœ¬åœ°å°±å¯ä»¥ä½¿ç”¨binè„šæœ¬ä¸­çš„å‘½ä»¤
````

#### æ•ˆæœ

```base
wlm
function is success
```

#### æ³¨æ„äº‹é¡¹

> éœ€è¦è¢«æ‰§è¡Œçš„æ–‡ä»¶éœ€è¦ä½¿ç”¨#!/usr/bin/env node è¿›è¡Œå£°æ˜ å¦åˆ™æ˜¯ä¸ç”Ÿæ•ˆçš„ï¼Œè¯¥å‘½ä»¤æ˜¯æ˜ å°„åˆ°å…¨å±€çš„ï¼Œæ‰€ä»¥ä½ åœ¨ä»»ä½•åœ°æ–¹éƒ½æ˜¯å¯ä»¥ç›´æ¥è¿›è¡Œä½¿ç”¨è¯¥å‘½ä»¤çš„ï¼Œå°±å’Œä½ ä½¿ç”¨vue-cliæ˜¯ä¸€æ ·çš„æ•ˆæœ

#### ç§»é™¤link

```base
npm unlink  // æ³¨æ„è¿™é‡Œå¿…é¡»åœ¨é¡¹ç›®æ–‡ä»¶ä¸­æ‰§è¡Œï¼Œä¸å¯ä»¥å…¨å±€æ‰§è¡Œ 
```

### å®ç°è¿‡ç¨‹

#### è„šæœ¬å‘½ä»¤å‚æ•°è®¾è®¡

```base
wlm --help æŸ¥çœ‹ä½¿ç”¨å¸®åŠ©
wlm -V |--version æŸ¥çœ‹å·¥å…·ç‰ˆæœ¬å·
wlm list  åˆ—å‡ºæ‰€æœ‰å¯ç”¨æ¨¡æ¿
wlm inti <template-name> <project-name> åŸºäºåˆ¶å®šæ¨¡æ¿è¿›è¡Œé¡¹ç›®åˆå§‹åŒ– <> ä»£è¡¨çš„æ˜¯å¿…å¡«é¡¹
```

> ä¸‹é¢çš„æ“ä½œéƒ½æ˜¯æœåŠ¡äºä¸Šé¢ğŸ‘†è¿™æ®µå‚æ•°è®¾è®¡ï¼Œé¦–å…ˆæ˜¯æˆ‘ä»¬å·²ç»å°†wlmçš„å‘½ä»¤æ‰§è¡Œåˆ°æœ¬åœ°ï¼Œnpm linkå·²ç»å®Œæˆäº†æˆ‘ä»¬éœ€è¦çš„ç¬¬ä¸€æ­¥ï¼Œåé¢å°±æ˜¯è¿™ä¹ˆåœ¨æˆ‘ä»¬è¾“å…¥wlmä¹‹åçš„å‘½ä»¤è¿›è¡Œæ“ä½œï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦å°†wlmåé¢è¾“å…¥çš„æ“ä½œæ•æ‰åˆ°ï¼Œå…¶å®nodeæä¾›ç»™æˆ‘ä»¬äº†åŸå§‹çš„æ“ä½œæ–¹å¼ï¼Œæ¯”å¦‚ä¸‹é¢

```js
log(process.argv) // æˆ‘å…¨å±€å£°æ˜äº† const log = console.log;  æ‰€ä»¥è¿™é‡Œç›´æ¥ä½¿ç”¨äº†log
è¾“å…¥ï¼šwlm iii
leimingwei@leimingweideMBP vue-cli-xa % wlm iii
[
  '/Users/leimingwei/.nvm/versions/node/v16.13.2/bin/node',
  '/Users/leimingwei/.nvm/versions/node/v16.13.2/bin/xa',
  'iii'
]
error: unknown command 'iii'
(Did you mean init?)
```

> å¯ä»¥çœ‹åˆ°å½“æˆ‘ä»¬è¾“å…¥å‘½ä»¤ä¹‹åï¼Œnodeè‡ªå¸¦çš„process.argv æ˜¯å¯ä»¥å°†æˆ‘ä»¬è¾“å…¥çš„å‚æ•°æ•æ‰åˆ°çš„ï¼Œä½†æ˜¯è¿™ç§å†™æ³•æˆ‘ä»¬æ˜¯å¾ˆéš¾å°†ç”¨æˆ·çš„æ‰€æœ‰æ“ä½œè¿›è¡Œå¤„ç†çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå·¥å…·ç±»æ¥ä»£æ›¿æˆ‘ä»¬åšè¿™ä»¶äº‹ï¼Œé‚£ä¹ˆè¿™ä¸ªå·¥å…·å°±æ˜¯commander

#### æ‰§è¡Œç”¨æˆ·è¾“å…¥çš„å‘½ä»¤è¡Œæ“ä½œ

```base
yarn add commander // å®‰è£…commanderå·¥å…·
import { Command } from 'commander'; //è¿›è¡Œå‘½ä»¤è¡Œçš„æ“ä½œ
const program = new Command();
```

- [commanderGithubåœ°å€](https://github.com/commander-rb/commander)

###### ä½¿ç”¨

```js

program
  .command('use') // æ­¤å¤„å°±æ˜¯å®šä¹‰ç”¨æˆ·çš„è¾“å…¥
  .description('å¦‚ä½•ä½¿ç”¨è¯¥cli') // å½“ç”¨æˆ·è¾“å…¥-h çš„æ—¶å€™æç¤ºçš„æè¿°ä¿¡æ¯
  // æ¥å—åˆ°ç”¨æˆ·è¾“å…¥çš„å‘½ä»¤ä¹‹åè¿›è¡Œçš„æ“ä½œ
  .action(()=>{
    log(logSymbols.info, chalk.yellow('ç¬¬ä¸€æ­¥ï¼šè¿è¡Œ wlm list'))
    log(logSymbols.info, chalk.yellow('ç¬¬äºŒæ­¥ï¼šè¿è¡Œ wlm init æ¨¡æ¿åç§° è‡ªå®šä¹‰åç§°'))
    log(logSymbols.info, chalk.yellow('ç¬¬ä¸‰æ­¥ï¼šæŒ‰ç…§æ­¥éª¤åˆå§‹åŒ–æ¨¡æ¿å³å¯'))
  })
  program.parse();
```

##### æ•ˆæœå±•ç¤ºï¼š

```base
leimingwei@leimingweideMBP lm-cli % wlm use 
â„¹ ç¬¬ä¸€æ­¥ï¼šè¿è¡Œ wlm list
â„¹ ç¬¬äºŒæ­¥ï¼šè¿è¡Œ wlm init æ¨¡æ¿åç§° è‡ªå®šä¹‰åç§°
â„¹ ç¬¬ä¸‰æ­¥ï¼šæŒ‰ç…§æ­¥éª¤åˆå§‹åŒ–æ¨¡æ¿å³å¯
```

> æœ‰äº†ä¸Šè¿°å·¥å…·ä¹‹åæˆ‘ä»¬å¯ä»¥åšçš„äº‹æƒ…å°±æ¯”è¾ƒå¤šäº†ï¼Œé¦–å…ˆå¯ä»¥è‡ªå®šä¹‰æŒ‡ä»¤ï¼Œä¹‹åå¯ä»¥æ ¹æ®è‡ªå®šä¹‰æŒ‡ä»¤è¿›è¡Œactionçš„æ“ä½œï¼Œactionä¸­æœ‰å›è°ƒå‚æ•°ï¼Œå¯ä»¥è·å–åˆ°å½“å‰ç”¨æˆ·çš„æ“ä½œç»“æœï¼Œå…·ä½“çš„ä½¿ç”¨è¯´æ˜å¯ä»¥çœ‹ğŸ”ä¸Šæ–¹æä¾›çš„githubé“¾æ¥ä¸­çš„è¯´æ˜æ–‡æ¡£ï¼Œè¿™é‡Œä¸åšèµ˜è¿°

###### è¯´æ˜

> è¯¥åŠŸèƒ½æ’ä»¶æä¾›å¾ˆå¤šå‘½ä»¤æ“ä½œå’Œå¾ˆå¤šé€‰é¡¹æ“ä½œï¼Œå¯ä»¥è‡ªå·±è¿›è¡Œå®šä¹‰ä¸€äº›åŠŸèƒ½æ“ä½œï¼Œæ¯”å¦‚è·å–åˆ°ç”¨æˆ·è¾“å…¥çš„å‘½ä»¤è¿›è¡Œä¸‹è½½æˆ–è€…æ‰§è¡Œä¸€äº›åŠ¨ä½œéƒ½æ˜¯å¯ä»¥çš„

###### ä¸‹è½½ç”¨æˆ·æƒ³è¦çš„æ–‡ä»¶

> ç”¨æˆ·çš„å‘½ä»¤æˆ‘ä»¬å·²ç»è·å–åˆ°äº†ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦è¿›è¡Œæ ¹æ®ç”¨æˆ·çš„è¦æ±‚ä¸‹è½½å¯¹åº”çš„ä»“åº“æ‰å¯ä»¥ï¼Œè¿™é‡Œæˆ‘ä»¬æ²¡åŠæ³•ç›´æ¥ä½¿ç”¨git clone ä¸‹è½½ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨ç¬¬ä¸‰æ–¹çš„ä¸‹è½½å·¥å…·ï¼Œdownload-git-repo è¯¥å·¥å…·å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç›´æ¥ä¸‹è½½æˆ‘ä»¬æä¾›å¥½çš„gitä¸‹è½½åœ°å€

- [download-git-repo](https://www.npmjs.com/package/download-git-repo)

###### git-repoåŸºæœ¬ä½¿ç”¨



```js
yarn add downlaod-git-repo
import download from 'download-git-repo'; 
```



```js
const downloadUrl  = 'åœ°å€' 
// PN || TN æ˜¯æˆ‘çš„å…¥å‚ ä½ ä»¬å¯ä»¥ç›´æ¥å†™æ­»è‡ªå·±éœ€è¦çš„é¡¹ç›®åå­—
download(downloadUrl, PN || TN, { clone: true }, (err) => {
  const spinner = ora('æ¨¡æ¿è·å–ä¸­...').start(); // oraåé¢ä¼šè¯´åˆ° ä¸€ä¸ªåŠ è½½åŠ¨ç”»
        if (err) {
          spinner.color = 'red';
          spinner.text = `æ¨¡æ¿è·å–å¤±è´¥ï¼Œè¯·é‡æ–°æ“ä½œ,å¤±è´¥åŸå› ï¼š${err}`;
          spinner.fail()
          return
        }
        spinner.color = 'green';
        spinner.text = 'æ¨¡æ¿ä¸‹è½½æˆåŠŸ';
        spinner.succeed()
      })
```



###### é™åˆ¶ç”¨æˆ·è¾“å…¥æ“ä½œå’Œé€‰æ‹©çš„è„šæœ¬

> å½“æˆ‘ä»¬å¯ä»¥çŸ¥é“äº†ç”¨æˆ·è¾“å…¥çš„å‘½ä»¤äº† ï¼Œé‚£ä¹ˆä¹‹åæˆ‘ä»¬è¦åšçš„å°±æ˜¯è¿™ä¹ˆå¯ä»¥è®©ç”¨æˆ·æœ‰é€‰æ‹©å’Œè¯¢é—®çš„æ•ˆæœï¼Œæ¯”å¦‚ï¼šæ˜¯å¦å®‰è£…è·¯ç”±ï¼Ÿæ˜¯å¦å®‰è£…piniaç­‰ç­‰æ“ä½œï¼Œè¿˜æœ‰ä¸€äº›æ˜¯ç»™ç”¨æˆ·é€‰æ‹©ï¼Œæ¯”å¦‚ä½ æ˜¯å®‰è£…vue2è¿˜æ˜¯vue3ç­‰ï¼Œè¿™ä¸ªåŠŸèƒ½éœ€è¦æˆ‘ä»¬ä½¿ç”¨å¦ä¸€ä¸ªå·¥å…·è¿›è¡Œå®ç°ï¼Œinquirerå·¥å…· 

- [inquirer-github](https://github.com/SBoudrias/Inquirer.js)

###### inquirerçš„åŸºæœ¬ä½¿ç”¨

```js
 inquirer
        .prompt([
          {
            type: 'input',
            name: 'name',
            message: "è¯·è¾“å…¥é¡¹ç›®åç§°"
          }, {
            type: 'input',
            name: 'description',
            message: "è¯·è¾“å…¥é¡¹ç›®ç®€ä»‹"
          }, {
            type: 'input',
            name: 'author',
            message: "è¯·è¾“å…¥ä½œè€…"
          }
        ])
        .then((answers) => {
          log.log(answers)
        })
        .catch((error) => {
          if (error.isTtyError) {
            log(logSymbols.error, chalk.red(error)) // è¿™é‡Œçš„logSymbols å’Œ chalk åé¢ä¼šè¯´åˆ° 
          } else {
            log(logSymbols.error, chalk.yellow(error))
   }
});
```

###### é‡å†™package.jsonæ–‡ä»¶

> å½“æˆ‘ä»¬æ‹¿åˆ°äº†ç”¨æˆ·çš„è¾“å…¥ï¼Œä¹Ÿå°†æ¨¡æ¿ä¸‹è½½å¥½äº†ï¼Œä¹Ÿå·²ç»è®©ç”¨æˆ·è‡ªå·±è¾“å…¥äº†è‡ªå®šä¹‰çš„å†…å®¹ï¼Œé‚£ä¹ˆä¸‹ä¸€æ­¥å°±æ˜¯æ€ä¹ˆå°†ç”¨æˆ·è¾“å…¥å¥½çš„ä¸œè¥¿è¿›è¡Œé‡æ–°å†™å…¥åˆ°æˆ‘ä»¬ä¸‹è½½å¥½çš„é¡¹ç›®ä¸­ï¼Œå½“ç„¶ä¸éœ€è¦æˆ‘ä»¬è‡ªå·±æ‰‹å†™ï¼Œéœ€è¦æˆ‘ä»¬å¼•å…¥ç¬¬ä¸‰æ–¹çš„å·¥å…·handlebars å’Œ nodeå†…ç½®çš„fsæ–‡ä»¶æ“ä½œæ¨¡å—

- [handlebars](https://github.com/handlebars-lang/handlebars.js)

###### handlebarsçš„åŸºæœ¬ä½¿ç”¨

```js
yarn add handlebars
import handlebars from 'handlebars' //æ¨¡æ¿å¼•æ“ 
import fs from 'fs' //node å†…ç½®æ¨¡å— ä¸éœ€è¦å•ç‹¬å¼•å…¥
```



###### é‡å†™json



```js
    const packagePath = `${PN}/package.json` //PN æ–‡ä»¶åå­—
    const packageContent = fs.readFileSync(packagePath, 'utf8')
    const packageFinalValue = handlebars.compile(packageContent)(PC)
    log(chalk.green(packageFinalValue))
    fs.writeFileSync(packagePath, packageFinalValue)
```





